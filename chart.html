<!DOCTYPE html>
<html>
  <head>
    <title>Agile Charts</title>
    <link href="layout.css" type="text/css" rel="stylesheet">
    <link href="colours.css" type="text/css" rel="stylesheet">
    <style type="text/css">
      #chart {
        margin: 1em 2%;
        padding: 0;
        height: 30em;
      }
    </style>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type='text/javascript'>
      function loadJSON(filePath) {
        var client = new XMLHttpRequest();
        client.open('GET', filePath, false);
        client.send();
        return JSON.parse(client.responseText);
      }
	  
      // TODO will need a random picker when we have more than one file.
      var defs = loadJSON('/yuriy-zubarev.json');

      function randInt(a, b) {
        return a + (Math.random() * (b - a));
      }

      function getRandomDefinition() {
        for (var key in defs) {
          if (!defs.hasOwnProperty(key)) continue;
          if (key === 'definitions') {
            return defs.definitions[Math.floor(Math.random()*defs.definitions.length)];
          }
        }
      }

      google.setOnLoadCallback(drawChart);
      google.load('visualization', '1.0', {'packages':['corechart']});

      // TODO add author link(s).
      function drawChart() {
        var options = {
          backgroundColor: '#333',
          title: 'Agile Process',
          titleTextStyle: { color: '#eee' },
          legend: { textStyle: { color: '#eee' } },
          fontSize: 20
        };

        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Activity');
        data.addColumn('number', 'Value');
        for (var i = 0; i < randInt(4, 7); i++) {
          var def = getRandomDefinition();
          var word = def['word'];
          console.log(word);
          data.addRows([
              [word, randInt(1, 5)],
              ]);
        }

        var chart = new google.visualization.PieChart(document.getElementById('chart'));
        chart.draw(data, options);

      }
    </script>
  </head>
  <body>
    <div id="chart">
    </div>
    <div class="footer">
      <p>This was made by <a href="http://plus.stuarthicks.me">calamari</a> and <a href="http://haku.me">haku</a>.</p>
    </div>
  </body>
</html>
